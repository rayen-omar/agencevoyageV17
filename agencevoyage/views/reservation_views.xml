<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue Formulaire R√©servation -->
    <record id="view_reservation_form" model="ir.ui.view">
        <field name="name">agencevoyage.reservation.form</field>
        <field name="model">agencevoyage.reservation</field>
        <field name="arch" type="xml">
            <form string="R√©servation">
                <style>
                    .o_form_view .o_field_widget input,
                    .o_form_view .o_field_widget textarea,
                    .o_form_view .o_field_widget select {
                        border: 2px solid #71639E !important;
                        border-radius: 4px;
                        padding: 8px 12px;
                        transition: all 0.3s ease;
                    }
                    
                    .o_form_view .o_field_widget input:hover,
                    .o_form_view .o_field_widget textarea:hover,
                    .o_form_view .o_field_widget select:hover {
                        border-color: #8B7BB8 !important;
                        box-shadow: 0 0 0 3px rgba(113, 99, 158, 0.1);
                    }
                    
                    .o_form_view .o_field_widget input:focus,
                    .o_form_view .o_field_widget textarea:focus,
                    .o_form_view .o_field_widget select:focus {
                        border-color: #71639E !important;
                        box-shadow: 0 0 0 3px rgba(113, 99, 158, 0.2);
                        outline: none;
                    }
                </style>
                <sheet>
                    <div class="oe_title">
                        <label for="name" string="R√©servation"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group>
                            <field name="date_reservation" required="1"/>
                            <field name="statut" required="1"/>
                            <field name="voyage_id" required="1"/>
                            <field name="client_id" required="1"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <!-- Voyageurs -->
                        <page string="üë• Voyageurs">
                            <group>
                                <group string="R√©sum√©">
                                    <field name="nombre_adultes" readonly="1"/>
                                    <field name="nombre_enfants" readonly="1"/>
                                    <field name="total_personnes" readonly="1"/>
                                </group>
                            </group>
                            
                            <field name="voyageur_ids" nolabel="1">
                                <tree string="Liste des voyageurs" create="1" delete="1">
                                    <field name="nom"/>
                                    <field name="type_voyageur"/>
                                    <field name="age"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <field name="nom"/>
                                            <field name="type_voyageur"/>
                                            <field name="age"/>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </page>

                        <!-- Chambres -->
                        <page string="üõèÔ∏è Chambres">
                            <field name="chambre_ids" nolabel="1">
                                <tree string="Chambres" create="1" delete="1">
                                    <field name="type_chambre"/>
                                    <field name="nombre_chambres"/>
                                    <field name="nombre_nuits"/>
                                    <field name="prix_nuit"/>
                                    <field name="total_chambre" readonly="1" sum="Total"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <field name="type_chambre"/>
                                            <field name="nombre_chambres"/>
                                            <field name="nombre_nuits"/>
                                            <field name="prix_nuit"/>
                                            <field name="total_chambre" readonly="1"/>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </page>

                        <!-- Calcul des prix -->
                        <page string="üí∞ Calcul des prix">
                            <group>
                                <group string="‚úàÔ∏è Transport">
                                    <field name="prix_transport" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Calcul√© automatiquement : (Prix adulte √ó Adultes) + (Prix enfant √ó Enfants)
                                        </p>
                                    </div>
                                </group>
                                
                                <group string="üè® H√¥tel">
                                    <field name="prix_hotel" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Bas√© sur les chambres r√©serv√©es
                                        </p>
                                    </div>
                                </group>
                            </group>
                            
                            <group>
                                <group string="üçΩÔ∏è Restauration">
                                    <field name="prix_restauration" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Bas√© sur les repas du voyage
                                        </p>
                                    </div>
                                </group>
                                
                                <group string="üë®‚Äçüè´ Guide">
                                    <field name="prix_guide" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Bas√© sur les guides du voyage
                                        </p>
                                    </div>
                                </group>
                            </group>
                            
                            <group>
                                <group string="üéí √âquipement">
                                    <field name="prix_equipement" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Bas√© sur les √©quipements du voyage
                                        </p>
                                    </div>
                                </group>
                                
                                <group string="üíµ Suppl√©ments">
                                    <field name="supplement_chambre"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Suppl√©ment pour chambres suppl√©mentaires
                                        </p>
                                    </div>
                                </group>
                            </group>
                            
                            <group class="oe_subtotal_footer oe_right">
                                <group string="Total">
                                    <field name="montant_total" readonly="1" class="oe_subtotal_footer_separator"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Paiements -->
                        <page string="üí≥ Paiements">
                            <field name="paiement_ids" nolabel="1">
                                <tree string="Paiements" create="1" delete="1">
                                    <field name="name"/>
                                    <field name="date_paiement"/>
                                    <field name="type_paiement_client"/>
                                    <field name="montant" sum="Total"/>
                                    <field name="mode_paiement"/>
                                    <field name="statut"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <field name="date_paiement"/>
                                            <field name="type_paiement_client"/>
                                            <field name="montant"/>
                                            <field name="mode_paiement"/>
                                            <field name="reference_bancaire"/>
                                            <field name="statut"/>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                            
                            <group class="oe_subtotal_footer oe_right">
                                <group string="R√©sum√©">
                                    <field name="montant_total" readonly="1"/>
                                    <div colspan="2">
                                        <p class="text-muted">
                                            Total de la r√©servation
                                        </p>
                                    </div>
                                </group>
                            </group>
                        </page>
                    </notebook>
                    
                    <group>
                        <group>
                            <field name="email_confirme"/>
                        </group>
                    </group>
                </sheet>

                <div class="oe_chatter">
                    <field name="message_follower_ids" groups="base.group_user"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Vue Liste R√©servation -->
    <record id="view_reservation_tree" model="ir.ui.view">
        <field name="name">agencevoyage.reservation.tree</field>
        <field name="model">agencevoyage.reservation</field>
        <field name="arch" type="xml">
            <tree string="R√©servations" decoration-info="statut == 'en_attente'" decoration-warning="statut == 'confirmee'" decoration-success="statut == 'terminee'" decoration-muted="statut == 'annulee'">
                <field name="name"/>
                <field name="date_reservation"/>
                <field name="statut"/>
                <field name="voyage_id"/>
                <field name="client_id"/>
                <field name="total_personnes"/>
                <field name="montant_total" sum="Total"/>
            </tree>
        </field>
    </record>

    <!-- Vue Recherche R√©servation -->
    <record id="view_reservation_search" model="ir.ui.view">
        <field name="name">agencevoyage.reservation.search</field>
        <field name="model">agencevoyage.reservation</field>
        <field name="arch" type="xml">
            <search string="Rechercher une R√©servation">
                <field name="name"/>
                <field name="voyage_id"/>
                <field name="client_id"/>
                
                <filter string="En attente" name="en_attente" domain="[('statut', '=', 'en_attente')]"/>
                <filter string="Confirm√©e" name="confirmee" domain="[('statut', '=', 'confirmee')]"/>
                <filter string="Termin√©e" name="terminee" domain="[('statut', '=', 'terminee')]"/>
                <filter string="Annul√©e" name="annulee" domain="[('statut', '=', 'annulee')]"/>
                
                <group expand="0" string="Grouper par">
                    <filter string="Statut" name="group_statut" context="{'group_by': 'statut'}"/>
                    <filter string="Voyage" name="group_voyage" context="{'group_by': 'voyage_id'}"/>
                    <filter string="Client" name="group_client" context="{'group_by': 'client_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action R√©servation -->
    <record id="action_reservation" model="ir.actions.act_window">
        <field name="name">R√©servations</field>
        <field name="res_model">agencevoyage.reservation</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_reservation_search"/>
    </record>
</odoo>
